<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" type="text/css" href="http://jsxgraph.uni-bayreuth.de/distrib/jsxgraph.css" />
  <script type="text/javascript" src="http://jsxgraph.uni-bayreuth.de/distrib/jsxgraphcore.js"></script>
  <title>Discovering Dynamical Systems</title>
</head>

<body>
  <h1>Discovering Dynamical Systems Through Experiment and Inquiry</h1>
  <div id="box" class="jxgbox" style="width:500px; height:500px;">
    <script type="text/javascript">
      // Initialize board, graphs, and sliders
      var board = JXG.JSXGraph.initBoard('box', {
        boundingbox: [-0.5, 1.5, 1.5, -0.5],
        axis: true,
        grid: true
      });
      var a = board.create('slider', [
        [0, 0],
        [0, 1],
        [0, 2, 4]
      ], {
        suffixLabel: 'a = '
      });
      var x0 = board.create('slider', [
        [0, 0],
        [1, 0],
        [0, 0.5, 1]
      ], {
        suffixLabel: 'x0 = '
      });
      function graphFunc(x) {
        return a.Value() * x * (1 - x);
      }
      var lineGraph = board.create('functiongraph',
        [function (x) {
          return x
        }, -0.5, 1.5], {
          strokeColor: 'green'
        }
      );
      var curveGraph = board.create('functiongraph',
        [graphFunc, -0.5, 1.5]
      );
      // Function to calculate the attracting and repelling points
      function generatePoints() {
        var i, xcors, ycors, xi;
        xcors = [x0.Value()]; // Populate xcors with the first value = x0
        ycors = [graphFunc(x0.Value())]; // Populate ycors with the first value = x1
        for (i = 0; i < 10; i++) {
          xi = ycors[ycors.length - 1]; // Next point to graph starts at the same y-coordinate as the previous
          // Add new point (xi, xi)
          xcors.push(xi);
          ycors.push(xi);
          // Add new point (xi, xi+1)
          xcors.push(xi);
          ycors.push(graphFunc(xi));
        }
        return {
          'xcors': xcors,
          'ycors': ycors
        };
      }
      // Create a step function that will be updated each time a or x0 changes
      var stepGraph = board.create('stepfunction', [
        [0], // Use as filler for now. It will be replaced on board update
        [0]
      ], {
        strokeColor: 'red'
      });
      // Re-calculate the attracting and repelling points each time the board is updated
      board.on('update', function () {
        var points = generatePoints();
        stepGraph.xterm = points['xcors'];
        stepGraph.yterm = points['ycors'];
      });
      // Update the board right away to replace (0,0) filler
      board.update(); // Not working the way I thought it would
    </script>
  </div>
</body>

</html>
